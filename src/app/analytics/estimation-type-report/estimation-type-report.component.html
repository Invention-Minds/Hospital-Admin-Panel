<div class="root-container">

  <div class="cancelButton">
    <div class="reportName">OPD Estimation Types</div>
    <div style="font-size: 20px; cursor: pointer;" (click)="closingReport()" class="" matTooltip="close" matTooltipPosition="above"><i class="fa-solid fa-xmark"></i></div>
  </div>
  <div class="report-filter">
    <div (click)="downloadExcel(this.importedData)" style="font-size: 20px; cursor: pointer;" class="" matTooltip="download"
      matTooltipPosition="above"><i class="fa-solid fa-download"></i>
    </div>

    <select name="" id="" [disabled]="!blockFilter" (change)="packageOnchange($event)">
      <option class="dummy" value="all" disabled selected hidden>Choose the Package</option>
      <option class="all">All</option>
      <option *ngFor="let pack of mhcPackages" [value]="pack.name">{{pack.name}}</option>
    </select>

    <select (change)="departmentOnchange($event)" [disabled]="blockFilter">
      <option class="dummy" value="all" disabled selected hidden>Choose the Department</option>
      <option value="all">All</option>
      <option *ngFor="let dept of department" [value]="dept.id">{{dept.name}}</option>
    </select>

    <select (change)="onChoosingDoctor($event)" [disabled]="blockFilter">
      <option class="dummy" value="all" disabled selected hidden>Choose the Doctor</option>
      <option value="all">All</option>
      <option *ngFor="let doc of doctors" [value]="doc.id">{{doc.name}}</option>
    </select>
    <div class="date-picker">
      <p-calendar styleClass="custom-calendar" selectionMode="range" [(ngModel)]="selectedDateRange"
        (ngModelChange)="onDateRangeSelect($event)"
        [placeholder]="type ? 'Please Select Date Range' : 'Please Select Date'" dateFormat="dd-mm-yy">
        <ng-template pTemplate="date" let-date>
          <span>
            {{ date.day }}
          </span>
        </ng-template>
      </p-calendar>
    </div>
    <div class="refreh" style="cursor: pointer;" (click)="refresh()" matTooltip="refreh" matTooltipPosition="above"><i
        class="fa-solid fa-arrows-rotate"></i></div>

  </div>

  <div class="table-container">
    <table border="1">
      <thead>
        <tr>
          <th rowspan="2">S.No</th>
          <th rowspan="2">Date</th>
          <th colspan="3">MM</th>
          <th colspan="3">SM</th>
          <th colspan="3">MM</th>
          <th colspan="3">Total Estimation Raised</th>
        </tr>
        <tr>
          <th>Planned</th>
          <th>Immediate</th>
          <th>Total</th>
          <th>Planned</th>
          <th>Immediate</th>
          <th>Total</th>
          <th>Planned</th>
          <th>Immediate</th>
          <th>Total</th>
          <th>Planned</th>
          <th>Immediate</th>
          <th>Grand Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of importedData; let i = index">
          <td>{{ i+1 }}</td>
          <td>{{ data.date }}</td>
          <td>{{ data.plannedMm }}</td>
          <td>{{ data.immediateMm }}</td>
          <td>{{ data.mmTotal }}</td>
          <td>{{ data.plannedSm }}</td>
          <td>{{ data.immediateSm }}</td>
          <td>{{ data.smTotal }}</td>
          <td>{{ data.plannedMatenity }}</td>
          <td>{{ data.immediateMatenity }}</td>
          <td>{{ data.totalMaternity }}</td>
          <td>{{ data.totalPlannedEstimation }}</td>
          <td>{{ data.totalImmediateEstimation }}</td>
          <td>{{ data.grandTotal }}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>